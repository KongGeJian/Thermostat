# 1. Thermostat

温控器

# 2. 清单

```
MCU：STC8G1K08 (1T)
FOSC：内部时钟 12.000M Hz 
EEPROM：设置 1K

OS：EasyOS  固定时间片

显示：3位数码管    驱动IC: TM1620
温度控制：继电器  GYB-1A-12D
```

# 3. 目录结构

代码在 ./src 目录下
```
+---APP - 程序入口
|       app.c
|       app.h
|       config.h
|       STARTUP.A51
|
+---BSP - 板载支持包。bsp_xxx 为BSP各个子模块
|       bsp.c - bsp入口文件
|       bsp.h - bsp入口头文件
|       bsp_buzzer.c
|       bsp_buzzer.h
|       bsp_eeprom.c
|       bsp_eeprom.h
|       bsp_heater.c
|       bsp_heater.h
|       bsp_kbd.c
|       bsp_kbd.h
|       bsp_led.c
|       bsp_led.h
|       bsp_ntc.c
|       bsp_ntc.h
|       bsp_oled.c
|       bsp_oled.h
|       bsp_uart.c
|       bsp_uart.h
|
+---EXT-LIB - 扩展的公共包
|       lib_delay.c - 延迟
|       lib_delay.h
|       lib_font_table.h - 自定义字符字典表
|       lib_stdint.h - C99引入的C标准库，C51没有，这里单独引入
|       lib_str.c - 自定义字符串操作
|       lib_str.h
|       lib_mem.c - 内存堆栈
|       lib_mem.h
|
\---RTX51 - RTX51 tiny 系统包
        Conf_tny.A51
        RTX51TNY.LIB
```

---
---

# 4. 设计说明
RTX51
## 4.1 温度精度

传感器测量精度控制在0.01，显示温度精度控制在0.1




# 5. 菜单&功能

## 菜单

```
显示
1. 指示灯：继电器吸合工作，指示灯亮起或闪烁。
2. 数码管：
    + 显示LL：表示传感器开路，接好传感器，正常显示当前温度；
    + 显示HH：表示超出测量范围，同时断开继电器；
    + 显示---：高温报警

设置 
1. P0 ———— 模式。默认值C。
    ┣ C ———— 制冷。当前 测量值>=设定值，继电器吸合
    ┗ H ———— 加热。温度 测量值<=设定值，继电器吸合
2. P1 ———— 回差设定。默认值0.1
    ┗ [0.1, 15] ———— 制冷模式下：测量值<=设定值-回差值，继电器断开；制冷模式下：测量值>=设定值+回差值，继电器断开
3. P2 ———— 温度上限。默认值300。
    ┗ [*, 300] ———— 单位°C。当前值>=设定值，断开继电器，蜂鸣器报警
4. P3 ———— 温度下限。默认值-40。
    ┗ [-40, *] ———— 单位°C。当前值<=设定值，断开继电器，蜂鸣器报警
5. P4 ———— 延时启动。默认值0
    ┗ [0, 30] ———— 单位：分钟
6. P5 ———— 温度校准。默认值0.0
    ┗ [-9.9, 9.9] ———— 单位°C。
7. P6 ———— 回复出厂设置
    ┗ --- ———— 确认操作后，闪烁三下并伴随“嘀”声。
```

## 功能

```
1. 长按「设置」，显示界面和设置模式来回切换。
2. 进入设置模式：
    2.1 短按「设置」，Px <-> 参数值 来回切换。比如显示P0，按一下设置，进入H/C选择，再按一下设置，退回，显示P0；
    2.2 Px 页面，可以按「加」「减」进行P0-P5之间循环切换；
    2.3 Px子页面，可以按「加」「减」进行数值调节；
    3.4 P6子页面，长按「加」和「减」，超过6s，回复出厂设置。
```
